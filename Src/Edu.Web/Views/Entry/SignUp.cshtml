<link href="~/Content/bootstrapValidator.css" rel="stylesheet" />
<script src="~/Scripts/bootstrapValidator.js"></script>
<link rel="stylesheet" href="/Content/upimg/amazeui.min.css">
<link rel="stylesheet" href="/Content/upimg/amazeui.cropper.css">
<link rel="stylesheet" href="/Content/upimg/custom_up_img.css">
<style type="text/css">
    .up-img-cover {
        width: 100px;
        height: 100px;
    }

        .up-img-cover img {
            position: absolute;
            width: 200px;
            height: 200px;
            left: 0;
            top: 0;
        }

    .panel .actions {
        position: absolute;
        right: 30px;
        top: 8px;
    }

        .panel .actions i {
            font-size: 0.875em;
            margin: 0 3px;
        }

            .panel .actions i:hover {
                cursor: pointer;
            }

    .card {
        margin-right: 0;
        margin-left: 0;
        background-color: #fff;
        border: 1px solid #ddd;
        border-width: 1px;
        border-radius: 4px 4px 0 0;
        -webkit-box-shadow: none;
        box-shadow: none;
        max-width: 280px;
        min-height: 36px;
    }

    .col-center-block {
        float: none;
        display: block;
        margin-left: auto;
        margin-right: auto;
    }
</style>
<style>
    .form-horizontal .form-control {
        background: #f0f0f0;
        border: none;
        box-shadow: none;
        padding: 0 10px 0 30px;
    }

    input[type="text"]:focus {
        background: #ffffff;
        border: 1px solid #cccccc;
    }

    .form-horizontal .form-group i {
        position: absolute;
        top: 20px;
        left: 22px;
        font-size: 17px;
        color: #c8c8c8;
        transition: all 0.5s ease 0s;
    }

    .form-horizontal .form-control:focus + i {
        color: #00b4ef;
    }
</style>
<ol class="breadcrumb">
    <li>新生报名</li>
</ol>
<div class="row">
    <div class="col-md-12">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h3 class="panel-title">学生信息</h3>
                <div class="actions pull-right">
                    <i class="glyphicon glyphicon-chevron-up"></i>
                </div>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-md-9" style="border-right:1px solid #ddd;">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="col-sm-2 control-label" for="txtName">学生姓名</label>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="txtName" name="txtName" value="" />
                                    </div>
                                    <label class="col-sm-2 control-label" for="">性别</label>
                                    <div class="col-sm-4 controls">
                                        <label class="radio-inline">
                                            <input type="radio" name="sex" id="optionsRadios1" value="option1" checked>
                                            男
                                        </label>
                                        <label class="radio-inline">
                                            <input type="radio" name="sex" id="optionsRadios2" value="option2">
                                            女
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="col-sm-2 control-label" for="txtName">生日</label>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="txtName" name="txtName" value="" />
                                    </div>
                                    <label class="col-sm-2 control-label" for="txtName">住址</label>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="txtName" name="txtName" value="" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="col-sm-2 control-label" for="txtName">所在学校</label>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="txtName" name="txtName" value="" />
                                    </div>
                                    <label class="col-sm-2 control-label" for="">年级班级</label>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="txtName" name="txtName" value="" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="col-sm-2 control-label" for="txtName">母亲电话</label>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="txtName" name="txtName" value="" />
                                    </div>
                                    <label class="col-sm-2 control-label" for="">父亲电话</label>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="txtName" name="txtName" value="" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="col-sm-2 control-label" for="txtName">其他电话</label>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="txtName" name="txtName" value="" />
                                    </div>
                                    <label class="col-sm-2 control-label" for="">备注</label>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control" id="txtName" name="txtName" value="" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3" id="updateForm">
                        <div class="up-img-cover" id="up-img-touch">
                            <img class="am-circle" alt="点击图片上传" src="/Content/img/student.png" data-am-popover="{content: '点击上传', trigger: 'hover focus'}">
                        </div>
                        <div><a style="text-align: center; display: block;" id="pic"></a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-12">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h3 class="panel-title">报名信息</h3>
                <div class="actions pull-right">
                    <i class="glyphicon glyphicon-chevron-up"></i>
                </div>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-md-9" style="border-right:1px solid #ddd;">
                        <div class="row">
                            <div class="col-mb-12 col-sm-12">
                                <div class="form-group">
                                    <label for="selectCourseType" class="col-sm-2 control-label">课程类别</label>
                                    <div class="col-sm-4">
                                        <select id="selectCourseType" class="form-control"></select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="selectCourse" class="col-sm-2 control-label">课程名称</label>
                                    <div class="col-sm-4">
                                        <select id="selectCourse" class="form-control"></select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-mb-12 col-sm-12">
                                <div class="form-group">
                                    <label for="selectClass" class="col-sm-2 control-label">选择班级</label>
                                    <div class="col-sm-4 form-inline">
                                        <select id="selectClass" class="form-control"></select>
                                    </div>
                                    <div class="col-sm-2 form-inline" style="padding-left:5px;padding-right:5px;">
                                        <label class="glyphicon glyphicon-remove"></label>
                                        <input type="number" maxlength='3' style="width:60px;" class="form-control" id="txtClassCount" name="txtClassCount" value="10" onchange="calcTuition();"/>
                                        <label class="control-label">课时</label>
                                    </div>
                                    <div class="col-sm-4 form-inline">
                                        <select style="width:80px;" id="selectDiscount" class="form-control" onchange="calcTuition();">
                                            <option value="0">原价</option>
                                            <option value="1">打折</option>
                                            <option value="2">优惠</option>
                                        </select>
                                        <input type="text" style="width:60px;" class="form-control hidden" id="txtDiscount" value="0"  onchange="calcTuition();"/>
                                        <select style="width:80px;" id="selectDiscountValue" class="form-control hidden" onchange="calcTuition();">
                                            <option value="1"></option>
                                            <option value="0.99">99</option>
                                            <option value="0.98">98</option>
                                            <option value="0.96">96</option>
                                            <option value="0.95">95</option>
                                            <option value="0.90">90</option>
                                            <option value="0.85">85</option>
                                            <option value="0.80">80</option>
                                            <option value="0.75">75</option>
                                            <option value="0.70">70</option>
                                            <option value="0.60">60</option>
                                            <option value="0.50">50</option>
                                        </select>
                                        <label id="lblDiscountType" style="margin-left:5px;margin-right:5px;" class="control-label hidden">元</label>

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-mb-12 col-sm-12">
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">教材项</label>
                                    <div class="col-sm-4">
                                        <div id="bookcard" class="card">

                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">杂费项</label>
                                    <div class="col-sm-4">
                                        <div id="othercard" class="card">

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="col-sm-4 control-label" for="spTuition">学费</label>
                                    <div class="col-sm-8">
                                        <span id="spTuition" style="font-size:medium" class="col-sm-6 badge badge-primary">¥ 0元</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="col-sm-4 control-label" for="spBookFee">教材费</label>
                                    <div class="col-sm-8">
                                        <span id="spBookFee" style="font-size:medium" class="col-sm-6 badge badge-primary">¥ 0元</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="col-sm-4 control-label" for="spOtherFee">杂费</label>
                                    <div class="col-sm-8">
                                        <span id="spOtherFee" style="font-size:medium" class="col-sm-6 badge badge-primary">¥ 0元</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="col-sm-4 control-label" for="txtResult">实收</label>
                                    <div class="col-sm-8">
                                        <input type="text" class="form-control" id="txtResult" name="txtResult" value="" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <button type="button" style="width:150px; margin-top:10px;" class="btn btn-primary col-center-block" data-toggle="modal" data-target="#ObjModal" onclick="Calcu();">
                                        去结算
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 模态框（Modal）是否确定删除 -->
    <div class="modal fade" id="ObjModal" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true" data-backdrop="false">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h5 class="modal-title" id="updateModalLabel">提示</h5>
                </div>
                <div class="modal-body">
                    <p>确认要删除该数据吗？</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">
                        取消
                    </button>
                    <button type="button" class="btn btn-primary" id="btnDeleteObj" onclick="deleteObj();">
                        确定
                    </button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>
</div>
<script>
    $(document).ready(function () {
        widgetToggle();
        getCourseType("selectCourseType");
        $("#selectCourseType").change(function () {
            $("#selectClass").empty();
            var selectedCoursTypeId = $(this).val();
            getCourseList("selectCourse", selectedCoursTypeId);
        });
    });
    var tuition = 0;
    var bookfee = 0;
    var otherfee = 0;
    var classcount = 0;
    var bookcount = 0;
    var othercount = 0;
    var result = [];
    $("#selectCourse").change(function () {
        var selectedCourseId = $(this).val();
        getClassByCourse(selectedCourseId, "selectClass");
        //var bookfee = getBookFeeByCourse(selectedCourseId);
        var bookcard = document.getElementById("bookcard");
        var othercard = document.getElementById("othercard");
        bookcard.innerHTML = "";
        othercard.innerHTML = "";
        var model = { 'courseId': selectedCourseId };
        $.ajax({
            url: "../Bookfee/getBookFeeByCourse",
            type: "post",
            data: JSON.stringify(model),
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                result = JSON.parse(data);
                var content1 = "";
                var content2 = "";
                for (var i = 0; i < result.length; i++) {
                    result[i].objCount = 1;
                    result[i].usable = true;
                    if (result[i].feeType == 1)//教材
                    {
                        content1 += "<div class='row'>";
                        content1 += "<div class='form-group'>";
                        content1 += " <div class='col-mb-12 col-sm-12  form-inline'>";
                        content1 += "<div class='radio'>";
                        content1 += "<input class='icheck' type='checkbox' onchange='radioChange(this," + i + ")' checked='' name='check1'>";
                        content1 += "<label>" + result[i].feeName + "</label>";
                        content1 += "</div>";
                        content1 += "<input type='text' style='width:50px;height:30px;' class='form-control' id='txtjcCount' name='txtjcCount' value='" + result[i].price + "' />";
                        content1 += "<label class='glyphicon glyphicon-remove'></label>";
                        content1 += "<input type='text' style='width:50px;height:30px;' class='form-control' id='txtzfCount' name='txtzfCount' value='1' />";
                        content1 += "</div></div></div>";
                    }
                    else if (result[i].feeType == 2)//杂费
                    {
                        content2 += "<div class='row'>";
                        content2 += "<div class='form-group'>";
                        content2 += " <div class='col-mb-12 col-sm-12  form-inline'>";
                        content2 += "<div class='radio'>";
                        content2 += "<input class='icheck' type='checkbox' onchange='radioChange(this," + i + ")' checked=''  name='check1'>";
                        content2 += "<label>" + result[i].feeName + "</label>";
                        content2 += "</div>";
                        content2 += "<input type='text' style='width:50px;height:30px;' class='form-control' id='txtjcCount' name='txtjcCount' onchange='changePrice(this," + i + ")' value='" + result[i].price + "' />";
                        content2 += "<label class='glyphicon glyphicon-remove'></label>";
                        content2 += "<input type='text' style='width:50px;height:30px;' class='form-control' id='txtzfCount' name='txtzfCount'  onchange='changeCount(this," + i + ")'  value='1' />";
                        content2 += "</div></div></div>";
                    }
                }
                bookcard.innerHTML = content1;
                othercard.innerHTML = content2;
            }
        });
    });
    $("#selectClass").change(function () {
        alert($("#selectClass").find("option:selected").attr("price"));
        var desc = $("#selectDiscount").val();

        if (desc == "0") {

        }
        else if (desc == "1") {

        }
        else if (desc == "2") {

        }
        var claCount = $("#txtClassCount").val();
    });
    $("#selectDiscount").change(function () {
        var desc = $(this).val();
        if (desc == '0') {
            $("#lblDiscountType").addClass("hidden");
            $("#txtDiscount").addClass("hidden");
            $("#selectDiscountValue").addClass("hidden");
        }
        else if (desc == '1') {
            $("#txtDiscount").addClass("hidden");
            $("#lblDiscountType").removeClass("hidden");
            $("#selectDiscountValue").removeClass("hidden");
            $("#lblDiscountType").text("折");

        }
        else if (desc == '2') {
            $("#selectDiscountValue").addClass("hidden");
            $("#lblDiscountType").removeClass("hidden");
            $("#txtDiscount").removeClass("hidden");
            $("#lblDiscountType").text("元");
        }

    });
    function calcTuition() {
        $("#txtClassCount").text();

    }
    function radioChange(obj, rusultIndex) {
        result[rusultIndex].usable = obj.checked;
    }
    function changePrice(obj, rusultIndex) {
        result[rusultIndex].price = $(obj).val();
    }
    function changeCount(obj, rusultIndex) {
        result[rusultIndex].objCount = $(obj).val();
    }
    function Calcu() {
        document.getElementById("txtResult")
        var tuition = 0;
        var bookfee = 0;
        var otherfee = 0;
        var classcount = 0;
        var bookcount = 0;
        var othercount = 0;
    }
</script>
